import { SecurityIcon } from '@patternfly/react-icons';
import saveAs from 'file-saver';
import omit from 'lodash/omit';
import propTypes from 'prop-types';
import React from 'react';
import { impactColorList, impactList } from './constants';

export const dataShape = propTypes.shape({
    data: propTypes.oneOfType([propTypes.object, propTypes.array]),
    meta: propTypes.object,
    isLoading: propTypes.bool
});

export function triggerFileDownload(data) {
    let blob = new Blob([data], { type: 'text/plain;charset=utf-8' });
    saveAs(blob, new Date().toISOString() + '.txt');
}

export function verifyParameters(apiProps, allowedParams) {
    if (apiProps) {
        const newParams = omit(apiProps, Object.keys(apiProps).filter(item => !allowedParams.includes(item)));
        Object.keys(newParams).forEach(key => (newParams[key] === undefined || newParams[key] === '') && delete newParams[key]);

        return newParams;
    }
}

export function getImpactDetails(impact) {
    if (Object.keys(impactList).includes(impact)) {
        return {
            title: impactList[impact].title,
            color: impactList[impact].color,
            text: impactList[impact].text,
            titleContent: (
                <span>
                    <SecurityIcon size="lg" />
                </span>
            )
        };
    } else {
        return {
            title: 'Unknown',
            color: impactColorList.default,
            text: '',
            titleContent: 'N/A'
        };
    }
}
