import { paths } from '../../../Utilities/Routes';
import { VulnerabilitiesTabs } from './VulnerabilitiesTabs';

describe('VulnerabilitiesTabs', () => {
    const location = {
        pathname: paths.vulnerabilitiesCves.to
    };
    const history = {
        push: jest.fn()
    };
    it('Should select first tab', () => {
        const wrapper = shallow(<VulnerabilitiesTabs location={location} history={history} />);
        const selectedTab = wrapper.props().children.props.activeKey;
        expect(selectedTab).toEqual(location.pathname);
    });

    it('Start with second tab and should click first tab', () => {
        const location = {
            pathname: paths.systems.to
        };
        const wrapper = shallow(<VulnerabilitiesTabs location={location} history={history} />);
        const redirect = wrapper
        .find('Tabs')
        .props()
        .onSelect('event', 'location');
        expect(history.push).toHaveBeenCalledWith('location');
    });
});
