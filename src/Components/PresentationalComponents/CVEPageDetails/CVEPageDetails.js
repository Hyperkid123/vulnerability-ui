import { Grid, GridItem, Stack, StackItem } from '@patternfly/react-core';
import propTypes from 'prop-types';
import React from 'react';
import CVEPageDetailsDescription from '../CVEPageDetailsDescription/CVEPageDetailsDescription';
import CVEPageDetailsSeverity from '../CVEPageDetailsSeverity/CVEPageDetailsSeverity';
import CVEPageDetailsTitle from '../CVEPageDetailsTitle/CVEPageDetailsTitle';
import WithLoader from '../WithLoader/WithLoader';

const CVEPageDetails = props => {
    return (
        <div className="cve-overview-card">
            <Stack gutter="md">
                <StackItem>
                    <WithLoader loading={props.data.isLoading}>
                        <CVEPageDetailsTitle title={props.data.data.synopsis} publish_date={props.data.data.public_date} />
                    </WithLoader>
                </StackItem>
                <StackItem>
                    <Grid gutter="sm">
                        <GridItem md={8} sm={12}>
                            <WithLoader loading={props.data.isLoading}>
                                <CVEPageDetailsDescription
                                    description={props.data.data.description}
                                    links={[props.data.data.rh_link, props.data.data.mitre_link]}
                                />
                            </WithLoader>
                        </GridItem>
                        <GridItem md={4} sm={12} className="severity-info-box">
                            <WithLoader loading={props.data.isLoading}>
                                <CVEPageDetailsSeverity
                                    impact={props.data.data.impact}
                                    cvss2_score={props.data.data.cvss2_score}
                                    cvss3_score={props.data.data.cvss3_score}
                                    cvss2_metrics={props.data.data.cvss2_metrics}
                                    cvss3_metrics={props.data.data.cvss3_metrics}
                                />
                            </WithLoader>
                        </GridItem>
                    </Grid>
                </StackItem>
            </Stack>
        </div>
    );
};

CVEPageDetails.propTypes = {
    data: propTypes.object
};

export default CVEPageDetails;
