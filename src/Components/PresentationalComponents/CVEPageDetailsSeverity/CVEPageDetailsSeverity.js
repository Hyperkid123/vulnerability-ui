import { Split, SplitItem, Stack, StackItem, Text, TextContent, TextVariants, Title } from '@patternfly/react-core';
import { Shield } from '@redhat-cloud-services/frontend-components';
import { parseCvssScore } from '@redhat-cloud-services/frontend-components-utilities/files/helpers';
import propTypes from 'prop-types';
import React from 'react';
import CvssVector from '../CvssVector/CvssVector';
import SeverityRating from '../SeverityRating/SeverityRating';
import './CVEPageDetailsSeverity.scss';

class CVEPageDetailsSeverity extends React.Component {
    constructor(props) {
        super(props);
        this.cvssScore = parseCvssScore(this.props.cvss2_score, this.props.cvss3_score);
    }

    render() {
        return (
            <React.Fragment>
                <Stack gutter="sm">
                    <StackItem>
                        <TextContent className="cve-cvss-base-score">
                            <Text component={TextVariants.h1}>{this.cvssScore}</Text>
                            <Text component={TextVariants.h4}>CVSS base score</Text>
                        </TextContent>
                    </StackItem>
                    <StackItem>
                        <TextContent>
                            <Text component={TextVariants.h6}>Severity</Text>
                        </TextContent>
                        <Split>
                            <SplitItem>
                                <Shield impact={this.props.impact} hasTooltip={false} size="md" />
                            </SplitItem>
                            <SplitItem>
                                <Title size="md">
                                    <SeverityRating impact={this.props.impact} format={'title'} />
                                </Title>
                            </SplitItem>
                        </Split>
                    </StackItem>
                    <StackItem>
                        <SeverityRating impact={this.props.impact} format={'link'} />
                    </StackItem>
                    <StackItem>
                        <CvssVector cvss2_metrics={this.props.cvss2_metrics} cvss3_metrics={this.props.cvss3_metrics} />
                    </StackItem>
                </Stack>
            </React.Fragment>
        );
    }
}

CVEPageDetailsSeverity.defaultProps = {
    impact: 'Unknown',
    cvss2_score: undefined,
    cvss3_score: undefined,
    cvss2_metrics: undefined,
    cvss3_metrics: undefined
};

CVEPageDetailsSeverity.propTypes = {
    impact: propTypes.string,
    cvss2_score: propTypes.any,
    cvss3_score: propTypes.any,
    cvss2_metrics: propTypes.any,
    cvss3_metrics: propTypes.any
};

export default CVEPageDetailsSeverity;
