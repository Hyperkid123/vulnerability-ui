import { init, inventoryEntitiesReducer } from './InventoryEntitiesReducer';

let action;
let columns;
let getSelected;
describe('inventoryEntitiesReducer', () => {
    beforeEach(() => {
        action = {
            type: undefined,
            payload: {}
        };
        columns = [
            { key: 'display_name', title: 'Name', composed: ['facts.os_release', 'fqdn'] },
            { key: 'cve_count', title: 'CVEs' },
            { key: 'updated', title: 'Last Seen', isTime: true }
        ];
        getSelected = () => { return new Set() };
    });

    it('Should return initial state', () => {
        const wrappingFn = inventoryEntitiesReducer(columns, getSelected);
        const reducer = wrappingFn(undefined, {});
        expect(reducer).toEqual(init);
    });

    it('Should set initial state on empty action', () => {
        const wrappingFn = inventoryEntitiesReducer(columns, getSelected);
        const reducer = wrappingFn(undefined, action);
        expect(reducer).toEqual(init);
    });

    it('Should set state for loaded entities', () => {
        const wrappingFn = inventoryEntitiesReducer(columns, getSelected);
        action.type = 'LOAD_ENTITIES_FULFILLED';
        const reducer = wrappingFn({ ...init, loaded: true }, action);
        expect(reducer).toEqual({ ...init, columns, loaded: true });
    });
});
