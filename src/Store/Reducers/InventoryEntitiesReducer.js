// Initial State
export const init = {
    columns: [],
    rows: [],
    entities: []
};
// Reducer

function modifyInventory(columns, state, getSelectedFunc) {
    // If a system does not have insights_id, it means it was deleted from inventory but somehow survived in Vuln backend
    if (state.loaded) {
        const selected = getSelectedFunc ? getSelectedFunc() : undefined;
        return {
            ...state,
            rows: selected ?
                state.rows.filter(item => item.insights_id).map(item => ({ ...item, selected: selected.has(item.id) })) :
                state.rows.filter(item => item.insights_id),
            columns
        };
    }

    return state;
}

export const inventoryEntitiesReducer = (columns, selected) => (state = init, action) => {
    switch (action.type) {
        case 'LOAD_ENTITIES_FULFILLED':
            return modifyInventory(columns, state, selected);

        default:
            return state;
    }
};
